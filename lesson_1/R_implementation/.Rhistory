tf_const <- tf$constant
tf_const <- tf$constant('kjshdflkasjdhf')
sess = tf$Session()
sess$run(tf_const)
library(keras)
library(ggplot2)
library(tensorflow)
library(tensorflow)
library(keras)
library(ggplot2)
library(dplyr)
library(tidyr)
mnist_ds <- dataset_mnist()
library(keras)
mnist_ds <- dataset_mnist()
use_condaenv('dply36')
mnist_ds <- dataset_mnist()
library(tensorflow)
library(keras)
library(ggplot2)
library(dplyr)
library(tidyr)
use_condaenv('dply36')
mnist_ds <- dataset_mnist()
library(tensorflow)
library(keras)
library(ggplot2)
library(dplyr)
library(tidyr)
use_condaenv('dlpy36')
mnist_ds <- dataset_mnist()
library(tensorflow)
library(keras)
library(ggplot2)
library(dplyr)
library(tidyr)
use_condaenv('dlpy36')
mnist_ds <- dataset_mnist()
install.packages(urllib)
install.packages('urllib')
mnist_ds <- dataset_mnist()
library(tensorflow)
library(keras)
library(ggplot2)
library(dplyr)
library(tidyr)
use_condaenv('dlpy36')
mnist_ds <- dataset_mnist()
library(tensorflow)
tf_const <- tf$constant("alksdjf;la")
use_condaenv('dlpy36')
tf_const <- tf$constant("alksdjf;la")
library(tensorflow)
tf_const <- tf$constant("alksdjf;la")
library(tensorflow)
use_condaenv('dlpy36')
tf_const <- tf$constant("alksdjf;la")
sess <- tf$Session()
sess$run(tf_const)
library(tensorflow)
use_condaenv('dlpy36')
tf_const <- tf$constant("alksdjf;la")
sess <- tf$Session()
sess$run(tf_const)
library(mxnet)
a <- mx.nd.ones(c(2,3), ctx = mx.gpu())
b <- a * 2 + 1
b
rm(*)
setwd('/home/otavio/Workspace/AI/fast_ai_lessons/lesson_1/R_implementation')
list.files()
library(mxnet)
library(dplyr)
library(tidyr)
library(ggplot2)
library(stringr)
library(readr)
# Loaging labels
labels <- read_table2("../../datasets/image_classification/oxford-iiit-pet/annotations/list.txt",
col_names = FALSE, comment = "#")
labels <- labels[,1:3]
names(labels) <- c("image_file", "class_id", "species")
# Preparing the labels dictionary
labels_dict <- labels %>%
mutate(image_file = str_replace(image_file, "_([0-9]{1,})", "")) %>%
mutate(image_file = str_replace_all(image_file, "_", " ")) %>%
mutate(species = if_else(species == 1, "cat", "dog")) %>%
mutate(breed_id = NULL) %>%
unique(.)
names(labels_dict) <- c("breed", "class", "species")
labels <- labels %>%
mutate(index = row.names(labels)) %>%
mutate(image_file = str_c(image_file, ".jpg", sep = ""))
labels <- labels[c("index", "class_id", "image_file")]
source("aux_functions.R")
input_list <- split_dataset(labels, 0.7, 0.15)
write_delim(input_list$train, "train_list", delim = " \t ", col_names = F)
write_delim(input_list$val, "val_list", delim = " \t ", col_names = F)
write_delim(input_list$test, "test_list", delim = " \t ", col_names = F)
View(input_list$train)
source("cnn_symbol.R")
symbol <- get_symbol(nrow(labels_dict))
im2rec(image_lst = "train_list",
root = "../datasets/image_classification/oxford-iiit-pet/images/",
output_rec = "train.bin")
im2rec(image_lst = "train_list",
root = "../../datasets/image_classification/oxford-iiit-pet/images/",
output_rec = "../../datasets/image_classification/oxford-iiit-pet/processed_files/train.bin")
im2rec(image_lst = "val_list",
root = "../../datasets/image_classification/oxford-iiit-pet/images/",
output_rec = "../../datasets/image_classification/oxford-iiit-pet/processed_files/val.bin")
im2rec(image_lst = "test_list",
root = "../../datasets/image_classification/oxford-iiit-pet/images/",
output_rec = "../../datasets/image_classification/oxford-iiit-pet/processed_files/test.bin")
train <- mx.io.ImageRecordIter(path.imgrec = "train.bin",
batch.size = 32,
data.shape = c(256, 256, 3))
val <- mx.io.ImageRecordIter(path.imgrec = "val.bin",
batch.size = 32,
data.shape = c(256, 256, 3))
model <- mx.model.FeedForward.create(
X = train,
eval.data = val,
ctx = mx.gpu(),
symbol = symbol,
eval.metric = mx.metric.top_k_accuracy,
num.round = 50,
batch.end.callback = mx.callback.log.train.metric(10),
epoch.end.callback = mx.callback.save.checkpoint("dg_classifier", period = 10),
verbose = T,
initializer = mx.init.Xavier()
)
require(mxnet)
if(!require(mlbench)){
install.packages('mlbench')
}
train <- mx.io.ImageRecordIter(path.imgrec = train_bin,
batch.size = 32,
data.shape = c(256, 256, 3))
train_bin <- "../../datasets/image_classification/oxford-iiit-pet/processed_files/train.bin"
val_bin <- "../../datasets/image_classification/oxford-iiit-pet/processed_files/val.bin"
test_bin <- "../../datasets/image_classification/oxford-iiit-pet/processed_files/val.bin"
im2rec(image_lst = "train_list",
root = "../../datasets/image_classification/oxford-iiit-pet/images/",
output_rec = train_bin)
im2rec(image_lst = "val_list",
root = "../../datasets/image_classification/oxford-iiit-pet/images/",
output_rec = val_bin)
im2rec(image_lst = "test_list",
root = "../../datasets/image_classification/oxford-iiit-pet/images/",
output_rec = test_bin)
train <- mx.io.ImageRecordIter(path.imgrec = train_bin,
batch.size = 32,
data.shape = c(256, 256, 3))
val <- mx.io.ImageRecordIter(path.imgrec = val_bin,
batch.size = 32,
data.shape = c(256, 256, 3))
model <- mx.model.FeedForward.create(
X = train,
eval.data = val,
ctx = mx.gpu(),
symbol = symbol,
eval.metric = mx.metric.top_k_accuracy,
num.round = 50,
batch.end.callback = mx.callback.log.train.metric(10),
epoch.end.callback = mx.callback.save.checkpoint("dg_classifier", period = 10),
verbose = T,
initializer = mx.init.Xavier()
)
use_condaenv("dlpy36")
library(keras)
use_condaenv(condaenv = "dlpy36")
library(keras)
use_condaenv("dlpy36")
library(keras)
use_condaenv("dlpy36")
get_keras_model <- function(input_shape, num_classes) {
inputs <- keras::layer_input(shape = input_shape)
# Conv block 1
conv_1_1 <- keras::layer_conv_2d(inputs, filters = 32, kernel_size = c(64,64), strides = c(2,2), activation = "relu", name = "conv_1_1")
conv_1_2 <- keras::layer_conv_2d(conv_1_1, filters = 32, kernel_size = c(64,64), strides = c(1,1), activation = "relu", name = "conv_1_2")
pool_1 <- keras::layer_max_pooling_2d(conv_1_2, pool_size = c(2,2), strides = c(2,2), name = "pool_1")
# Conv block 2
conv_2_1 <- keras::layer_conv_2d(pool_1, filters = 128, kernel_size = c(32,32), strides = c(2,2), activation = "relu", name = "conv_2_1")
conv_2_2 <- keras::layer_conv_2d(conv_2_1, filters = 128, kernel_size = c(32,32), strides = c(1,1), activation = "relu", name = "conv_2_2")
pool_2 <- keras::layer_max_pooling_2d(conv_2_2, pool_size = c(2,2), strides = c(2,2), name = "pool_2")
# Conv block 3
conv_3_1 <- keras::layer_conv_2d(pool_2, filters = 256, kernel_size = c(16,16), strides = c(2,2), activation = "relu", name = "conv_3_1")
conv_3_2 <- keras::layer_conv_2d(conv_3_1, filters = 256, kernel_size = c(16,16), strides = c(1,1), activation = "relu", name = "conv_3_2")
pool_3 <- keras::layer_max_pooling_2d(conv_3_2, pool_size = c(2,2), strides = c(2,2), name = "pool_3")
# Conv block 4
conv_4_1 <- keras::layer_conv_2d(pool_3, filters = 512, kernel_size = c(4,4), strides = c(2,2), activation = "relu", name = "conv_4_1")
conv_4_2 <- keras::layer_conv_2d(conv_4_1, filters = 512, kernel_size = c(4,4), strides = c(1,1), activation = "relu", name = "conv_4_2")
flat_pool <- keras::layer_global_average_pooling_2d(conv_4_2, name = "avg_global_pool")
fc_1 <- keras::layer_dense(flat_pool, units = 2048, activation = "relu", name = "fc_1")
do_1 <- keras::layer_dropout(fc_1, rate = 0.5, name = "do_1")
fc_2 <- keras::layer_dense(do_1, units = 128, activation = "relu", name = "fc_2")
do_2 <- keras::layer_dropout(fc_2, rate = 0.35, name = "do_2")
logits <- keras::layer_dense(do_2, units = num_classes, activation = None, name = "logits")
output <- keras::layer_activation(logits, activation = "softmax", name = "output")
model <- keras_model(inputs = inputs, outputs = output)
return(model)
}
model <- get_keras_model(input_shape = c(256,256,3), num_classes = 37)
get_keras_model <- function(input_shape, num_classes) {
inputs <- keras::layer_input(shape = input_shape)
# Conv block 1
conv_1_1 <- keras::layer_conv_2d(inputs, filters = 32, kernel_size = c(64,64), strides = c(2,2), activation = "relu", name = "conv_1_1")
conv_1_2 <- keras::layer_conv_2d(conv_1_1, filters = 32, kernel_size = c(64,64), strides = c(1,1), activation = "relu", name = "conv_1_2")
pool_1 <- keras::layer_max_pooling_2d(conv_1_2, pool_size = c(2,2), strides = c(2,2), name = "pool_1")
# Conv block 2
#conv_2_1 <- keras::layer_conv_2d(pool_1, filters = 128, kernel_size = c(32,32), strides = c(2,2), activation = "relu", name = "conv_2_1")
#conv_2_2 <- keras::layer_conv_2d(conv_2_1, filters = 128, kernel_size = c(32,32), strides = c(1,1), activation = "relu", name = "conv_2_2")
#pool_2 <- keras::layer_max_pooling_2d(conv_2_2, pool_size = c(2,2), strides = c(2,2), name = "pool_2")
# Conv block 3
#conv_3_1 <- keras::layer_conv_2d(pool_2, filters = 256, kernel_size = c(16,16), strides = c(2,2), activation = "relu", name = "conv_3_1")
#conv_3_2 <- keras::layer_conv_2d(conv_3_1, filters = 256, kernel_size = c(16,16), strides = c(1,1), activation = "relu", name = "conv_3_2")
#pool_3 <- keras::layer_max_pooling_2d(conv_3_2, pool_size = c(2,2), strides = c(2,2), name = "pool_3")
# Conv block 4
#conv_4_1 <- keras::layer_conv_2d(pool_3, filters = 512, kernel_size = c(4,4), strides = c(2,2), activation = "relu", name = "conv_4_1")
#conv_4_2 <- keras::layer_conv_2d(conv_4_1, filters = 512, kernel_size = c(4,4), strides = c(1,1), activation = "relu", name = "conv_4_2")
#flat_pool <- keras::layer_global_average_pooling_2d(conv_4_2, name = "avg_global_pool")
#fc_1 <- keras::layer_dense(flat_pool, units = 2048, activation = "relu", name = "fc_1")
#do_1 <- keras::layer_dropout(fc_1, rate = 0.5, name = "do_1")
#fc_2 <- keras::layer_dense(do_1, units = 128, activation = "relu", name = "fc_2")
#do_2 <- keras::layer_dropout(fc_2, rate = 0.35, name = "do_2")
#logits <- keras::layer_dense(do_2, units = num_classes, activation = None, name = "logits")
#output <- keras::layer_activation(logits, activation = "softmax", name = "output")
output <- pool_1
model <- keras_model(inputs = inputs, outputs = output)
return(model)
}
model <- get_keras_model(input_shape = c(256,256,3), num_classes = 37)
model$summary()
model$summary()
print(model$summary())
model$summary
summary(model)
get_keras_model <- function(input_shape, num_classes) {
inputs <- keras::layer_input(shape = input_shape)
# Conv block 1
conv_1_1 <- keras::layer_conv_2d(inputs, filters = 32, kernel_size = c(64,64), strides = c(1,1), activation = "relu", name = "conv_1_1")
conv_1_2 <- keras::layer_conv_2d(conv_1_1, filters = 32, kernel_size = c(64,64), strides = c(1,1), activation = "relu", name = "conv_1_2")
pool_1 <- keras::layer_max_pooling_2d(conv_1_2, pool_size = c(2,2), strides = c(2,2), name = "pool_1")
# Conv block 2
#conv_2_1 <- keras::layer_conv_2d(pool_1, filters = 128, kernel_size = c(32,32), strides = c(2,2), activation = "relu", name = "conv_2_1")
#conv_2_2 <- keras::layer_conv_2d(conv_2_1, filters = 128, kernel_size = c(32,32), strides = c(1,1), activation = "relu", name = "conv_2_2")
#pool_2 <- keras::layer_max_pooling_2d(conv_2_2, pool_size = c(2,2), strides = c(2,2), name = "pool_2")
# Conv block 3
#conv_3_1 <- keras::layer_conv_2d(pool_2, filters = 256, kernel_size = c(16,16), strides = c(2,2), activation = "relu", name = "conv_3_1")
#conv_3_2 <- keras::layer_conv_2d(conv_3_1, filters = 256, kernel_size = c(16,16), strides = c(1,1), activation = "relu", name = "conv_3_2")
#pool_3 <- keras::layer_max_pooling_2d(conv_3_2, pool_size = c(2,2), strides = c(2,2), name = "pool_3")
# Conv block 4
#conv_4_1 <- keras::layer_conv_2d(pool_3, filters = 512, kernel_size = c(4,4), strides = c(2,2), activation = "relu", name = "conv_4_1")
#conv_4_2 <- keras::layer_conv_2d(conv_4_1, filters = 512, kernel_size = c(4,4), strides = c(1,1), activation = "relu", name = "conv_4_2")
#flat_pool <- keras::layer_global_average_pooling_2d(conv_4_2, name = "avg_global_pool")
#fc_1 <- keras::layer_dense(flat_pool, units = 2048, activation = "relu", name = "fc_1")
#do_1 <- keras::layer_dropout(fc_1, rate = 0.5, name = "do_1")
#fc_2 <- keras::layer_dense(do_1, units = 128, activation = "relu", name = "fc_2")
#do_2 <- keras::layer_dropout(fc_2, rate = 0.35, name = "do_2")
#logits <- keras::layer_dense(do_2, units = num_classes, activation = None, name = "logits")
#output <- keras::layer_activation(logits, activation = "softmax", name = "output")
output <- pool_1
model <- keras_model(inputs = inputs, outputs = output)
return(model)
}
model <- get_keras_model(input_shape = c(256,256,3), num_classes = 37)
summary(model)
get_keras_model <- function(input_shape, num_classes) {
inputs <- keras::layer_input(shape = input_shape)
# Conv block 1
conv_1_1 <- keras::layer_conv_2d(inputs, filters = 32, kernel_size = c(4,4), strides = c(1,1), activation = "relu", name = "conv_1_1")
conv_1_2 <- keras::layer_conv_2d(conv_1_1, filters = 32, kernel_size = c(4,4), strides = c(1,1), activation = "relu", name = "conv_1_2")
pool_1 <- keras::layer_max_pooling_2d(conv_1_2, pool_size = c(2,2), strides = c(2,2), name = "pool_1")
# Conv block 2
#conv_2_1 <- keras::layer_conv_2d(pool_1, filters = 128, kernel_size = c(32,32), strides = c(2,2), activation = "relu", name = "conv_2_1")
#conv_2_2 <- keras::layer_conv_2d(conv_2_1, filters = 128, kernel_size = c(32,32), strides = c(1,1), activation = "relu", name = "conv_2_2")
#pool_2 <- keras::layer_max_pooling_2d(conv_2_2, pool_size = c(2,2), strides = c(2,2), name = "pool_2")
# Conv block 3
#conv_3_1 <- keras::layer_conv_2d(pool_2, filters = 256, kernel_size = c(16,16), strides = c(2,2), activation = "relu", name = "conv_3_1")
#conv_3_2 <- keras::layer_conv_2d(conv_3_1, filters = 256, kernel_size = c(16,16), strides = c(1,1), activation = "relu", name = "conv_3_2")
#pool_3 <- keras::layer_max_pooling_2d(conv_3_2, pool_size = c(2,2), strides = c(2,2), name = "pool_3")
# Conv block 4
#conv_4_1 <- keras::layer_conv_2d(pool_3, filters = 512, kernel_size = c(4,4), strides = c(2,2), activation = "relu", name = "conv_4_1")
#conv_4_2 <- keras::layer_conv_2d(conv_4_1, filters = 512, kernel_size = c(4,4), strides = c(1,1), activation = "relu", name = "conv_4_2")
#flat_pool <- keras::layer_global_average_pooling_2d(conv_4_2, name = "avg_global_pool")
#fc_1 <- keras::layer_dense(flat_pool, units = 2048, activation = "relu", name = "fc_1")
#do_1 <- keras::layer_dropout(fc_1, rate = 0.5, name = "do_1")
#fc_2 <- keras::layer_dense(do_1, units = 128, activation = "relu", name = "fc_2")
#do_2 <- keras::layer_dropout(fc_2, rate = 0.35, name = "do_2")
#logits <- keras::layer_dense(do_2, units = num_classes, activation = None, name = "logits")
#output <- keras::layer_activation(logits, activation = "softmax", name = "output")
output <- pool_1
model <- keras_model(inputs = inputs, outputs = output)
return(model)
}
model <- get_keras_model(input_shape = c(16,16,3), num_classes = 37)
summary(model)
get_keras_model <- function(input_shape, num_classes) {
inputs <- keras::layer_input(shape = input_shape)
# Conv block 1
conv_1_1 <- keras::layer_conv_2d(inputs, filters = 32, kernel_size = c(4,4), strides = c(1,1), activation = "relu", padding = "same", name = "conv_1_1")
conv_1_2 <- keras::layer_conv_2d(conv_1_1, filters = 32, kernel_size = c(4,4), strides = c(1,1), activation = "relu", name = "conv_1_2")
pool_1 <- keras::layer_max_pooling_2d(conv_1_2, pool_size = c(2,2), strides = c(2,2), name = "pool_1")
# Conv block 2
#conv_2_1 <- keras::layer_conv_2d(pool_1, filters = 128, kernel_size = c(32,32), strides = c(2,2), activation = "relu", name = "conv_2_1")
#conv_2_2 <- keras::layer_conv_2d(conv_2_1, filters = 128, kernel_size = c(32,32), strides = c(1,1), activation = "relu", name = "conv_2_2")
#pool_2 <- keras::layer_max_pooling_2d(conv_2_2, pool_size = c(2,2), strides = c(2,2), name = "pool_2")
# Conv block 3
#conv_3_1 <- keras::layer_conv_2d(pool_2, filters = 256, kernel_size = c(16,16), strides = c(2,2), activation = "relu", name = "conv_3_1")
#conv_3_2 <- keras::layer_conv_2d(conv_3_1, filters = 256, kernel_size = c(16,16), strides = c(1,1), activation = "relu", name = "conv_3_2")
#pool_3 <- keras::layer_max_pooling_2d(conv_3_2, pool_size = c(2,2), strides = c(2,2), name = "pool_3")
# Conv block 4
#conv_4_1 <- keras::layer_conv_2d(pool_3, filters = 512, kernel_size = c(4,4), strides = c(2,2), activation = "relu", name = "conv_4_1")
#conv_4_2 <- keras::layer_conv_2d(conv_4_1, filters = 512, kernel_size = c(4,4), strides = c(1,1), activation = "relu", name = "conv_4_2")
#flat_pool <- keras::layer_global_average_pooling_2d(conv_4_2, name = "avg_global_pool")
#fc_1 <- keras::layer_dense(flat_pool, units = 2048, activation = "relu", name = "fc_1")
#do_1 <- keras::layer_dropout(fc_1, rate = 0.5, name = "do_1")
#fc_2 <- keras::layer_dense(do_1, units = 128, activation = "relu", name = "fc_2")
#do_2 <- keras::layer_dropout(fc_2, rate = 0.35, name = "do_2")
#logits <- keras::layer_dense(do_2, units = num_classes, activation = None, name = "logits")
#output <- keras::layer_activation(logits, activation = "softmax", name = "output")
output <- pool_1
model <- keras_model(inputs = inputs, outputs = output)
return(model)
}
model <- get_keras_model(input_shape = c(16,16,3), num_classes = 37)
summary(model)
get_keras_model <- function(input_shape, num_classes) {
inputs <- keras::layer_input(shape = input_shape)
# Conv block 1
conv_1_1 <- keras::layer_conv_2d(inputs, filters = 32, kernel_size = c(64,64), strides = c(1,1), activation = "relu", name = "conv_1_1")
conv_1_2 <- keras::layer_conv_2d(conv_1_1, filters = 32, kernel_size = c(64,64), strides = c(1,1), activation = "relu", name = "conv_1_2")
pool_1 <- keras::layer_max_pooling_2d(conv_1_2, pool_size = c(2,2), strides = c(2,2), name = "pool_1")
# Conv block 2
#conv_2_1 <- keras::layer_conv_2d(pool_1, filters = 128, kernel_size = c(32,32), strides = c(2,2), activation = "relu", name = "conv_2_1")
#conv_2_2 <- keras::layer_conv_2d(conv_2_1, filters = 128, kernel_size = c(32,32), strides = c(1,1), activation = "relu", name = "conv_2_2")
#pool_2 <- keras::layer_max_pooling_2d(conv_2_2, pool_size = c(2,2), strides = c(2,2), name = "pool_2")
# Conv block 3
#conv_3_1 <- keras::layer_conv_2d(pool_2, filters = 256, kernel_size = c(16,16), strides = c(2,2), activation = "relu", name = "conv_3_1")
#conv_3_2 <- keras::layer_conv_2d(conv_3_1, filters = 256, kernel_size = c(16,16), strides = c(1,1), activation = "relu", name = "conv_3_2")
#pool_3 <- keras::layer_max_pooling_2d(conv_3_2, pool_size = c(2,2), strides = c(2,2), name = "pool_3")
# Conv block 4
#conv_4_1 <- keras::layer_conv_2d(pool_3, filters = 512, kernel_size = c(4,4), strides = c(2,2), activation = "relu", name = "conv_4_1")
#conv_4_2 <- keras::layer_conv_2d(conv_4_1, filters = 512, kernel_size = c(4,4), strides = c(1,1), activation = "relu", name = "conv_4_2")
#flat_pool <- keras::layer_global_average_pooling_2d(conv_4_2, name = "avg_global_pool")
#fc_1 <- keras::layer_dense(flat_pool, units = 2048, activation = "relu", name = "fc_1")
#do_1 <- keras::layer_dropout(fc_1, rate = 0.5, name = "do_1")
#fc_2 <- keras::layer_dense(do_1, units = 128, activation = "relu", name = "fc_2")
#do_2 <- keras::layer_dropout(fc_2, rate = 0.35, name = "do_2")
#logits <- keras::layer_dense(do_2, units = num_classes, activation = None, name = "logits")
#output <- keras::layer_activation(logits, activation = "softmax", name = "output")
output <- pool_1
model <- keras_model(inputs = inputs, outputs = output)
return(model)
}
model <- get_keras_model(input_shape = c(256,256,3), num_classes = 37)
summary(model)
help(keras::layer_max_pooling_2d)
help(layer_max_pooling_2d)
help(layer_conv_2d)
help(mx.symbol.Convolution)
get_keras_model <- function(input_shape, num_classes) {
inputs <- keras::layer_input(shape = input_shape)
# Conv block 1
conv_1_1 <- keras::layer_conv_2d(inputs, filters = 32, kernel_size = c(64,64), strides = c(1,1), activation = "relu", padding = "same", name = "conv_1_1")
conv_1_2 <- keras::layer_conv_2d(conv_1_1, filters = 32, kernel_size = c(64,64), strides = c(1,1), activation = "relu", name = "conv_1_2")
pool_1 <- keras::layer_max_pooling_2d(conv_1_2, pool_size = c(2,2), strides = c(2,2), name = "pool_1")
# Conv block 2
#conv_2_1 <- keras::layer_conv_2d(pool_1, filters = 128, kernel_size = c(32,32), strides = c(2,2), activation = "relu", name = "conv_2_1")
#conv_2_2 <- keras::layer_conv_2d(conv_2_1, filters = 128, kernel_size = c(32,32), strides = c(1,1), activation = "relu", name = "conv_2_2")
#pool_2 <- keras::layer_max_pooling_2d(conv_2_2, pool_size = c(2,2), strides = c(2,2), name = "pool_2")
# Conv block 3
#conv_3_1 <- keras::layer_conv_2d(pool_2, filters = 256, kernel_size = c(16,16), strides = c(2,2), activation = "relu", name = "conv_3_1")
#conv_3_2 <- keras::layer_conv_2d(conv_3_1, filters = 256, kernel_size = c(16,16), strides = c(1,1), activation = "relu", name = "conv_3_2")
#pool_3 <- keras::layer_max_pooling_2d(conv_3_2, pool_size = c(2,2), strides = c(2,2), name = "pool_3")
# Conv block 4
#conv_4_1 <- keras::layer_conv_2d(pool_3, filters = 512, kernel_size = c(4,4), strides = c(2,2), activation = "relu", name = "conv_4_1")
#conv_4_2 <- keras::layer_conv_2d(conv_4_1, filters = 512, kernel_size = c(4,4), strides = c(1,1), activation = "relu", name = "conv_4_2")
#flat_pool <- keras::layer_global_average_pooling_2d(conv_4_2, name = "avg_global_pool")
#fc_1 <- keras::layer_dense(flat_pool, units = 2048, activation = "relu", name = "fc_1")
#do_1 <- keras::layer_dropout(fc_1, rate = 0.5, name = "do_1")
#fc_2 <- keras::layer_dense(do_1, units = 128, activation = "relu", name = "fc_2")
#do_2 <- keras::layer_dropout(fc_2, rate = 0.35, name = "do_2")
#logits <- keras::layer_dense(do_2, units = num_classes, activation = None, name = "logits")
#output <- keras::layer_activation(logits, activation = "softmax", name = "output")
output <- pool_1
model <- keras_model(inputs = inputs, outputs = output)
return(model)
}
model <- get_keras_model(input_shape = c(256,256,3), num_classes = 37)
summary(model)
get_keras_model <- function(input_shape, num_classes) {
inputs <- keras::layer_input(shape = input_shape)
# Conv block 1
conv_1_1 <- keras::layer_conv_2d(inputs, filters = 32, kernel_size = c(32,32), strides = c(1,1), activation = "relu", padding = "same", name = "conv_1_1")
conv_1_2 <- keras::layer_conv_2d(conv_1_1, filters = 32, kernel_size = c(32,32), strides = c(1,1), activation = "relu", name = "conv_1_2")
pool_1 <- keras::layer_max_pooling_2d(conv_1_2, pool_size = c(2,2), strides = c(2,2), name = "pool_1")
# Conv block 2
#conv_2_1 <- keras::layer_conv_2d(pool_1, filters = 128, kernel_size = c(32,32), strides = c(2,2), activation = "relu", name = "conv_2_1")
#conv_2_2 <- keras::layer_conv_2d(conv_2_1, filters = 128, kernel_size = c(32,32), strides = c(1,1), activation = "relu", name = "conv_2_2")
#pool_2 <- keras::layer_max_pooling_2d(conv_2_2, pool_size = c(2,2), strides = c(2,2), name = "pool_2")
# Conv block 3
#conv_3_1 <- keras::layer_conv_2d(pool_2, filters = 256, kernel_size = c(16,16), strides = c(2,2), activation = "relu", name = "conv_3_1")
#conv_3_2 <- keras::layer_conv_2d(conv_3_1, filters = 256, kernel_size = c(16,16), strides = c(1,1), activation = "relu", name = "conv_3_2")
#pool_3 <- keras::layer_max_pooling_2d(conv_3_2, pool_size = c(2,2), strides = c(2,2), name = "pool_3")
# Conv block 4
#conv_4_1 <- keras::layer_conv_2d(pool_3, filters = 512, kernel_size = c(4,4), strides = c(2,2), activation = "relu", name = "conv_4_1")
#conv_4_2 <- keras::layer_conv_2d(conv_4_1, filters = 512, kernel_size = c(4,4), strides = c(1,1), activation = "relu", name = "conv_4_2")
#flat_pool <- keras::layer_global_average_pooling_2d(conv_4_2, name = "avg_global_pool")
#fc_1 <- keras::layer_dense(flat_pool, units = 2048, activation = "relu", name = "fc_1")
#do_1 <- keras::layer_dropout(fc_1, rate = 0.5, name = "do_1")
#fc_2 <- keras::layer_dense(do_1, units = 128, activation = "relu", name = "fc_2")
#do_2 <- keras::layer_dropout(fc_2, rate = 0.35, name = "do_2")
#logits <- keras::layer_dense(do_2, units = num_classes, activation = None, name = "logits")
#output <- keras::layer_activation(logits, activation = "softmax", name = "output")
output <- pool_1
model <- keras_model(inputs = inputs, outputs = output)
return(model)
}
model <- get_keras_model(input_shape = c(256,256,3), num_classes = 37)
summary(model)
get_keras_model <- function(input_shape, num_classes) {
inputs <- keras::layer_input(shape = input_shape)
# Conv block 1
conv_1_1 <- keras::layer_conv_2d(inputs, filters = 32, kernel_size = c(32,32), strides = c(1,1), activation = "relu", padding = "same", name = "conv_1_1")
conv_1_2 <- keras::layer_conv_2d(conv_1_1, filters = 32, kernel_size = c(32,32), strides = c(1,1), activation = "relu", padding = "same", name = "conv_1_2")
pool_1 <- keras::layer_max_pooling_2d(conv_1_2, pool_size = c(2,2), strides = c(2,2), name = "pool_1")
# Conv block 2
#conv_2_1 <- keras::layer_conv_2d(pool_1, filters = 128, kernel_size = c(32,32), strides = c(2,2), activation = "relu", name = "conv_2_1")
#conv_2_2 <- keras::layer_conv_2d(conv_2_1, filters = 128, kernel_size = c(32,32), strides = c(1,1), activation = "relu", name = "conv_2_2")
#pool_2 <- keras::layer_max_pooling_2d(conv_2_2, pool_size = c(2,2), strides = c(2,2), name = "pool_2")
# Conv block 3
#conv_3_1 <- keras::layer_conv_2d(pool_2, filters = 256, kernel_size = c(16,16), strides = c(2,2), activation = "relu", name = "conv_3_1")
#conv_3_2 <- keras::layer_conv_2d(conv_3_1, filters = 256, kernel_size = c(16,16), strides = c(1,1), activation = "relu", name = "conv_3_2")
#pool_3 <- keras::layer_max_pooling_2d(conv_3_2, pool_size = c(2,2), strides = c(2,2), name = "pool_3")
# Conv block 4
#conv_4_1 <- keras::layer_conv_2d(pool_3, filters = 512, kernel_size = c(4,4), strides = c(2,2), activation = "relu", name = "conv_4_1")
#conv_4_2 <- keras::layer_conv_2d(conv_4_1, filters = 512, kernel_size = c(4,4), strides = c(1,1), activation = "relu", name = "conv_4_2")
#flat_pool <- keras::layer_global_average_pooling_2d(conv_4_2, name = "avg_global_pool")
#fc_1 <- keras::layer_dense(flat_pool, units = 2048, activation = "relu", name = "fc_1")
#do_1 <- keras::layer_dropout(fc_1, rate = 0.5, name = "do_1")
#fc_2 <- keras::layer_dense(do_1, units = 128, activation = "relu", name = "fc_2")
#do_2 <- keras::layer_dropout(fc_2, rate = 0.35, name = "do_2")
#logits <- keras::layer_dense(do_2, units = num_classes, activation = None, name = "logits")
#output <- keras::layer_activation(logits, activation = "softmax", name = "output")
output <- pool_1
model <- keras_model(inputs = inputs, outputs = output)
return(model)
}
model <- get_keras_model(input_shape = c(256,256,3), num_classes = 37)
summary(model)
get_keras_model <- function(input_shape, num_classes) {
inputs <- keras::layer_input(shape = input_shape)
# Conv block 1
conv_1_1 <- keras::layer_conv_2d(inputs, filters = 32, kernel_size = c(32,32), strides = c(1,1), activation = "relu", padding = "same", name = "conv_1_1")
conv_1_2 <- keras::layer_conv_2d(conv_1_1, filters = 32, kernel_size = c(32,32), strides = c(1,1), activation = "relu", padding = "same", name = "conv_1_2")
pool_1 <- keras::layer_max_pooling_2d(conv_1_2, pool_size = c(4,4), strides = c(2,2), name = "pool_1")
# Conv block 2
#conv_2_1 <- keras::layer_conv_2d(pool_1, filters = 128, kernel_size = c(32,32), strides = c(2,2), activation = "relu", name = "conv_2_1")
#conv_2_2 <- keras::layer_conv_2d(conv_2_1, filters = 128, kernel_size = c(32,32), strides = c(1,1), activation = "relu", name = "conv_2_2")
#pool_2 <- keras::layer_max_pooling_2d(conv_2_2, pool_size = c(2,2), strides = c(2,2), name = "pool_2")
# Conv block 3
#conv_3_1 <- keras::layer_conv_2d(pool_2, filters = 256, kernel_size = c(16,16), strides = c(2,2), activation = "relu", name = "conv_3_1")
#conv_3_2 <- keras::layer_conv_2d(conv_3_1, filters = 256, kernel_size = c(16,16), strides = c(1,1), activation = "relu", name = "conv_3_2")
#pool_3 <- keras::layer_max_pooling_2d(conv_3_2, pool_size = c(2,2), strides = c(2,2), name = "pool_3")
# Conv block 4
#conv_4_1 <- keras::layer_conv_2d(pool_3, filters = 512, kernel_size = c(4,4), strides = c(2,2), activation = "relu", name = "conv_4_1")
#conv_4_2 <- keras::layer_conv_2d(conv_4_1, filters = 512, kernel_size = c(4,4), strides = c(1,1), activation = "relu", name = "conv_4_2")
#flat_pool <- keras::layer_global_average_pooling_2d(conv_4_2, name = "avg_global_pool")
#fc_1 <- keras::layer_dense(flat_pool, units = 2048, activation = "relu", name = "fc_1")
#do_1 <- keras::layer_dropout(fc_1, rate = 0.5, name = "do_1")
#fc_2 <- keras::layer_dense(do_1, units = 128, activation = "relu", name = "fc_2")
#do_2 <- keras::layer_dropout(fc_2, rate = 0.35, name = "do_2")
#logits <- keras::layer_dense(do_2, units = num_classes, activation = None, name = "logits")
#output <- keras::layer_activation(logits, activation = "softmax", name = "output")
output <- pool_1
model <- keras_model(inputs = inputs, outputs = output)
return(model)
}
model <- get_keras_model(input_shape = c(256,256,3), num_classes = 37)
summary(model)
get_keras_model <- function(input_shape, num_classes) {
inputs <- keras::layer_input(shape = input_shape)
# Conv block 1
conv_1_1 <- keras::layer_conv_2d(inputs, filters = 32, kernel_size = c(32,32), strides = c(1,1), activation = "relu", padding = "same", name = "conv_1_1")
conv_1_2 <- keras::layer_conv_2d(conv_1_1, filters = 32, kernel_size = c(32,32), strides = c(1,1), activation = "relu", padding = "same", name = "conv_1_2")
pool_1 <- keras::layer_max_pooling_2d(conv_1_2, pool_size = c(4,4), strides = c(2,2), padding = "valid", name = "pool_1")
# Conv block 2
#conv_2_1 <- keras::layer_conv_2d(pool_1, filters = 128, kernel_size = c(32,32), strides = c(2,2), activation = "relu", name = "conv_2_1")
#conv_2_2 <- keras::layer_conv_2d(conv_2_1, filters = 128, kernel_size = c(32,32), strides = c(1,1), activation = "relu", name = "conv_2_2")
#pool_2 <- keras::layer_max_pooling_2d(conv_2_2, pool_size = c(2,2), strides = c(2,2), name = "pool_2")
# Conv block 3
#conv_3_1 <- keras::layer_conv_2d(pool_2, filters = 256, kernel_size = c(16,16), strides = c(2,2), activation = "relu", name = "conv_3_1")
#conv_3_2 <- keras::layer_conv_2d(conv_3_1, filters = 256, kernel_size = c(16,16), strides = c(1,1), activation = "relu", name = "conv_3_2")
#pool_3 <- keras::layer_max_pooling_2d(conv_3_2, pool_size = c(2,2), strides = c(2,2), name = "pool_3")
# Conv block 4
#conv_4_1 <- keras::layer_conv_2d(pool_3, filters = 512, kernel_size = c(4,4), strides = c(2,2), activation = "relu", name = "conv_4_1")
#conv_4_2 <- keras::layer_conv_2d(conv_4_1, filters = 512, kernel_size = c(4,4), strides = c(1,1), activation = "relu", name = "conv_4_2")
#flat_pool <- keras::layer_global_average_pooling_2d(conv_4_2, name = "avg_global_pool")
#fc_1 <- keras::layer_dense(flat_pool, units = 2048, activation = "relu", name = "fc_1")
#do_1 <- keras::layer_dropout(fc_1, rate = 0.5, name = "do_1")
#fc_2 <- keras::layer_dense(do_1, units = 128, activation = "relu", name = "fc_2")
#do_2 <- keras::layer_dropout(fc_2, rate = 0.35, name = "do_2")
#logits <- keras::layer_dense(do_2, units = num_classes, activation = None, name = "logits")
#output <- keras::layer_activation(logits, activation = "softmax", name = "output")
output <- pool_1
model <- keras_model(inputs = inputs, outputs = output)
return(model)
}
model <- get_keras_model(input_shape = c(256,256,3), num_classes = 37)
summary(model)
